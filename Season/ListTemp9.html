<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listado de Capítulos</title>
    <link rel="stylesheet" href="..\Styles\ListStyles.css">
</head>
<body>
    <div class="title_container">
        <h1 class="title">Series App</h1>
    </div>

    <div class="grid-container" id="gridContainer">
        <!-- Aquí se generará dinámicamente el listado de capítulos -->
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var gridContainer = document.getElementById('gridContainer');
    
            // Generar 94 capítulos
            for (var i = 1; i <= 94; i++) {
                var capitulo = document.createElement('div');
                capitulo.className = 'grid-item';
                capitulo.innerHTML = '<a href="#" onclick="fetchEpisode(' + i + ')">Capítulo ' + i + '</a>';
                
                gridContainer.appendChild(capitulo);
            }
        });

        function fetchEpisode(episodeNumber) {
            // Realizar una solicitud AJAX para enviar el número del capítulo al servidor
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        // Redirigir a la URL devuelta por el servidor
                        console.log('Respuesta del servidor:', xhr.responseText);
                        window.location.href = xhr.responseText;
                        
                    } else {
                        console.error('Error al obtener el enlace del capítulo.');
                        console.error('Error en la solicitud AJAX. Estado:', xhr.status);
                        console.error('Respuesta del servidor:', xhr.responseText);
                    }
                }
            };
            xhr.open('GET', '../Function/GenerateLinkTemp9.php?episode=' + episodeNumber, true);
            xhr.send();
        }
    </script>

</body>
</html>